(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))n(c);new MutationObserver(c=>{for(const s of c)if(s.type==="childList")for(const u of s.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&n(u)}).observe(document,{childList:!0,subtree:!0});function r(c){const s={};return c.integrity&&(s.integrity=c.integrity),c.referrerPolicy&&(s.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?s.credentials="include":c.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(c){if(c.ep)return;c.ep=!0;const s=r(c);fetch(c.href,s)}})();const m="http://localhost:5000";document.addEventListener("DOMContentLoaded",P);let a,b,p=0,h={};const o={next_quiz:document.querySelector("#next_button"),check_answer:document.querySelector("#check_button"),quiz_options_labels:document.querySelectorAll(".answer"),radio_buttons:document.querySelectorAll("input[name='answer']"),quiz_ques:document.querySelector(".quiz_question"),login_button:document.querySelector("#login_button"),signup_button:document.querySelector("#signup_button"),quiz_answer_check:document.querySelector("#answer_check"),signup_form:document.querySelector("#account_form"),login_form:document.querySelector("#login_form_div"),game_progress:document.querySelector("#game_progress"),quiz_div:document.querySelector("#quizes"),activity_selection_buttons:document.querySelectorAll("#select_activity"),activity_div:document.querySelector("#activity_selection_div"),quiz_content:document.querySelector("#quiz_content"),display_correct_answer:document.querySelector("#correct_answer"),grammar_exercise_container:document.querySelector(".grammar_exercise_container"),img_wrapper:document.querySelector(".img_wrapper"),img_name_wrapper:document.querySelector(".name_wrapper"),login_form_submit:document.querySelector("#login_form"),logout:document.querySelector("#logout"),logout_button:document.querySelector("#logout_button"),matching_game_instruction:document.querySelector("#matching_game_instruction"),play_word_speech:document.querySelector(".play_word_speech"),select_speech_practice_div:document.querySelector("#select_speech_practice_div"),word_speech:document.querySelector("#word_speech"),speech_practice_answers:Array.from(document.querySelectorAll(".speech_practice_answers")),close_button:document.querySelector("#close-button"),next_speech:document.querySelector("#next_speech"),delete_account:document.querySelector("#delete_account_button")};function P(){O(),j(),B()}function O(){let e=[];if(o.login_button&&o.login_button.addEventListener("click",redirectToLogin),o.activity_div)for(let t=0;t<o.activity_selection_buttons.length;t++)e.push(o.activity_selection_buttons[t]),e[t].addEventListener("click",D);o.signup_button&&o.signup_button.addEventListener("click",showSignupForm),o.login_form_submit&&o.login_form_submit.addEventListener("submit",x),o.signup_form&&o.signup_form.addEventListener("submit",$),o.check_answer&&o.check_answer.addEventListener("click",Y),o.next_quiz&&o.next_quiz.addEventListener("click",R),o.logout_button&&o.logout_button.addEventListener("click",E),o.delete_account&&o.delete_account.addEventListener("click",H),o.speech_practice_answers&&o.speech_practice_answers.forEach(t=>t.addEventListener("click",Z)),o.close_button&&o.close_button.addEventListener("click",N),document.getElementById("closePopup")&&document.getElementById("closePopup").addEventListener("click",y)}function B(){document.getElementById("logout").classList.add("hide"),document.getElementById("delete_account_button").classList.add("hide")}function M(){return localStorage.getItem("token")}function $(e){e.preventDefault();const t=new FormData(o.signup_form),r={};t.forEach((n,c)=>{r[c]=n}),fetch(`${m}/create_user`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}).then(n=>{if(!n.ok)throw new Error("Failed to create user");return n.json()}).then(n=>{alert("User created successfully"),o.signup_form.reset(),window.location.href="./login.html"}).catch(n=>{console.error(n),alert("Failed to create user")})}function x(e){e.preventDefault();const t=new FormData(o.login_form_submit),r={};t.forEach((n,c)=>{r[c]=n}),fetch(`${m}/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r),credentials:"include"}).then(n=>{if(!n.ok)throw new Error("Failed to get user");return n.json()}).then(n=>{alert("Login successful"),localStorage.setItem("token",n.token),localStorage.setItem("user_id",n.user.id),localStorage.setItem("user_score",n.user.score),window.location.href="./profile.html",o.login_form_submit.reset()}).catch(n=>{console.error(n),console.log(n),alert("Failed to get user")})}function j(){const e=localStorage.getItem("token");fetch(`${m}/check_session`,{method:"GET",headers:{Authorization:`Bearer ${e}`},credentials:"include"}).then(t=>t.json()).then(t=>{t.user?(F(t.user,t.score),document.getElementById("logout").classList.remove("hide"),document.getElementById("delete_account_button").classList.remove("hide")):document.querySelector("#display_msg").innerHTML="Log in to view your profile"}).catch(t=>console.error("Error:",t))}function F(e,t){const r=document.querySelector("#age"),n=document.querySelector("#display_msg"),c=document.querySelector("#score");document.querySelector("#yoruba_display_level"),document.querySelector("#yoruba_display_score"),document.getElementById("profile_redirect_login").classList.add("hide"),n.innerHTML+=`Welcome, ${e.first_name}`,r.innerHTML+=`Age: ${e.age}`,c.innerHTML+=`Total XP: ${t}`}function E(){fetch(`${m}/logout`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include"}).then(e=>e.json()).then(e=>{document.querySelector("#display_msg").innerHTML="Log in to view your profile",document.getElementById("logout").classList.add("hide"),document.getElementById("profile_redirect_login").classList.remove("hide"),localStorage.removeItem("token"),localStorage.removeItem("score"),localStorage.removeItem("user_id"),window.location.reload()}).catch(e=>console.error("Error:",e))}function H(){const e=localStorage.getItem("user_id"),t=localStorage.getItem("token"),r={id:e};fetch(`${m}/delete_user`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify(r),credentials:"include"}).then(n=>{if(!n.ok)throw new Error("Network response was not ok");return n.json()}).then(n=>{E(),localStorage.removeItem("token"),localStorage.removeItem("user_id"),localStorage.removeItem("score")}).catch(n=>console.error("Error:",n))}function D(e){o.activity_div.classList.add("hide"),document.getElementById("exit_link").classList.add("hide"),document.getElementById("close-button").classList.remove("hide"),e.target.classList.contains("select_quiz")&&(o.quiz_content.classList.remove("hide"),w()),e.target.classList.contains("select_grammar_exercises")&&(o.matching_game_instruction.remove("hide"),o.grammar_exercise_container.classList.remove("hide"),J()),e.target.classList.contains("select_speech_practice")&&(o.select_speech_practice_div.classList.remove("hide"),K())}function N(){location.reload()}async function w(){try{const e="https://raw.githubusercontent.com/Seyi-Toluhi/language_learning_app/main/frontend/src/json_files/Yoruba.json",t=new Request(e),n=await(await fetch(t)).json();U(n)}catch(e){console.log("Failed to fetch quiz questions",e.message)}}const I=e=>{let t;if(Object.keys(h).length<e){for(;;)if(t=Math.floor(Math.random()*e),!h[t])return h[t]=!0,t}else Q()};function U(e){const t=["a","b","c","d"];let r=I(12),n=e;const c=n[r].quiz;b=n[r].correctAnswer,o.quiz_ques.textContent=c;for(let s=0;s<t.length;s++){let u=n[r].answers[`${t[s]}`];o.quiz_options_labels[s].innerHTML=`${u}`,o.radio_buttons[s].setAttribute("value",`${u}`)}}function Y(){let e;for(const t of o.radio_buttons)if(t.checked){e=t.value;break}if(e)if(e===b){if(M()&&(localStorage.setItem("score",p),p<12)){p++;let t=parseInt(localStorage.getItem("score"));t=t+1,localStorage.setItem("score",t),p==12&&v()}V()}else X();else alert("Please pick your answer")}function Q(){const t=localStorage.getItem("score"),r=document.createElement("div");r.className="result-container",t==12?r.innerHTML=`You're a gem. You got ${t} out of 12 in Yoruba and earned 20 XP`:r.innerHTML=`Quiz Completed.You got ${t} out of 12 in Yoruba. To earn 20 XP, you need a score of 12`,o.quiz_content.appendChild(r),o.game_progress.classList.add("hide"),o.quiz_div.classList.add("hide")}async function v(){let e=parseInt(localStorage.getItem("user_id")),t=localStorage.getItem("token");const r={XP:20,id:e};if(await fetch(`${m}/update_user_score`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify(r),credentials:"include"}),response.status!==200)throw new Error("Unable to update score")}function V(){o.quiz_answer_check.classList.add("hide_check"),a=document.createElement("div");const e=document.createElement("p"),t=document.createElement("button");a.setAttribute("id","answer_div"),a.style.backgroundColor="green",e.textContent="That's Correct",t.textContent="Continue",a.append(e,t),t.addEventListener("click",A),o.game_progress.appendChild(a)}function X(){o.quiz_answer_check.classList.add("hide_check"),a=document.createElement("div");const e=document.createElement("p"),t=document.createElement("button");a.setAttribute("id","answer_div"),a.style.backgroundColor="red",e.textContent=`That's Wrong. The correct answer is ${b}`,t.textContent="Continue",a.append(e,t),t.addEventListener("click",A),o.game_progress.appendChild(a)}function A(){w(),o.quiz_answer_check.classList.remove("hide_check"),a&&o.game_progress.removeChild(a)}function R(){w()}const f=[{name:"Omi",image:"water.jpg"},{name:"Ero Ibanisoro",image:"telephone.png"},{name:"Baba",image:"father.jpg"},{name:"Omo",image:"child.jpg"},{name:"Iya",image:"mother.jpg"}],W=["Baba","Omi","Ero Ibanisoro","Iya","Omo"];function J(){let e=!1,t,r,n=[...W],c=[];n.sort(()=>Math.random()-.5);for(let i=0;i<f.length;i++)o.img_wrapper.innerHTML+=`<div class="img-container" data-item-value="${f[i].name}">
  <div class="img-display">
  <img src="images/${f[i].image}" class="image"/></div>
  </div>`,o.img_name_wrapper.innerHTML+=`<div class="name-container" data-item-value="${n[i]}"><span>${n[i]}</span>
  </div>`;let s=Array.from(document.querySelectorAll(".img-container")),u=Array.from(document.querySelectorAll(".name-container"));c=[...s,...u];let S=0;c.forEach(i=>{i.addEventListener("click",()=>{if(!e)e=i,e.style.backgroundColor="rgba(112, 177, 212, 0.2)",t=i.getAttribute("data-item-value"),i.getAttribute("class");else{let d=i;if(r=i.getAttribute("data-item-value"),i.getAttribute("class"),t===r)S++,e.style.backgroundColor="rgba(0,255,0,0.1)",d.style.backgroundColor="rgba(0,255,0,0.1)",e.classList.remove("firstElementClass"),d.classList.remove("secondElementClass"),e.classList.add("disabled"),d.classList.add("disabled"),e=!1;else{const g=e,L=d;e.style.backgroundColor="",e.classList.add("red-background"),d.classList.add("red-background"),setTimeout(()=>{g.classList.remove("red-background"),L.classList.remove("red-background")},500),e=!1}}if(S===5){const d=document.querySelector("#result"),g=document.createElement("p");g.innerText="You must be proud of yourself! You've earned 20 XP",v(),o.grammar_exercise_container.classList.add("hide"),d.appendChild(g),localStorage.getItem("Yoruba_XP_earned")||(localStorage.setItem("Yoruba_XP",100),localStorage.setItem("Yoruba_XP_earned","true"))}})})}const _=[{word:"Omi",options:{a:"Cup",b:"Water",c:"Food"},correctAnswer:"Water"},{word:"Baba",options:{a:"Mother",b:"Child",c:"Father"},correctAnswer:"Father"},{word:"Odabo",options:{a:"Goodbye",b:"Please",c:"Sorry"},correctAnswer:"Goodbye"},{word:"Bawo ni",options:{a:"Thanks",b:"Hello",c:"Sorry"},correctAnswer:"Hello"},{word:"Jowo",options:{a:"Thanks",b:"Sorry",c:"Please"},correctAnswer:"Please"}];let l=[];function G(){l=speechSynthesis.getVoices(),l.length||(speechSynthesis.onvoiceschanged=()=>{l=speechSynthesis.getVoices()})}function q(e){const t=new SpeechSynthesisUtterance(e.target.getAttribute("id")),r=l[2]||l[0];t.voice=r,speechSynthesis.speak(t)}let C,T=0;function K(){z()}function z(){if(T<5){const e=I(5);o.word_speech.innerHTML=_[e].word,C=_[e].correctAnswer,o.play_word_speech.setAttribute("id",_[e].word),o.play_word_speech.removeEventListener("click",q),o.play_word_speech.addEventListener("click",q),Object.values(_[e].options).forEach((r,n)=>{o.speech_practice_answers[n].textContent=r})}else o.select_speech_practice_div.classList.add("hide"),v(),document.getElementById("speech_practice_completed").classList.remove("hide")}function Z(e){e.target.innerHTML===C?(T++,k("Correct! Well done!"),ee(),setTimeout(y,1e3),z()):(k("Incorrect! Try again!"),te(),setTimeout(y,1e3))}function ee(){const e=new SpeechSynthesisUtterance("Correct! Well done"),t=l[3]||l[0];e.voice=t,speechSynthesis.speak(e)}function te(){const e=new SpeechSynthesisUtterance("Incorrect! Try again"),t=l[3]||l[0];e.voice=t,speechSynthesis.speak(e)}function k(e){document.getElementById("feedbackMessage").textContent=e,document.getElementById("popupContainer").style.display="flex"}function y(){document.getElementById("popupContainer").style.display="none"}G();
